(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     71519,       1901]
NotebookOptionsPosition[     67459,       1790]
NotebookOutlinePosition[     67813,       1806]
CellTagsIndexPosition[     67770,       1803]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Wechat Chat History Tools", "Section",
 CellChangeTimes->{{3.6949652908412867`*^9, 3.694965303124968*^9}, {
  3.695136820064152*^9, 3.69513682867754*^9}}],

Cell["\<\
Version 2.1:
2017-6-23
Added message sender individual counts.
Reorganized the notebook.
Version 2:
Database format based on the newest version as of 2016 Dec
If you receive lots of errors, it is likely that the database format has \
changed again, since this has happened before.\
\>", "Text",
 CellChangeTimes->{{3.695136978072743*^9, 3.695137047175165*^9}, {
  3.707190944482356*^9, 
  3.707191015469468*^9}},ExpressionUUID->"4e08a831-78c9-4605-86ee-\
ccc52aa0af0e"],

Cell["\<\
User manual: evaluate all cells in the given order, change the information \
specified. You can ignore the comments in code.\
\>", "Text",
 CellChangeTimes->{{3.6951371135664454`*^9, 3.695137186696726*^9}, {
  3.695137242691074*^9, 3.695137249637054*^9}}],

Cell[CellGroupData[{

Cell["Initialization code", "Subsection",
 CellChangeTimes->{{3.6951377429425898`*^9, 
  3.695137748113785*^9}},ExpressionUUID->"621b03b7-8eff-418a-bf96-\
568020b65cd9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Needs", "[", "\"\<DatabaseLink`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"loadWechatDatabase", "[", 
    RowBox[{"mmpath_", ",", "contpath_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
       "I", " ", "did", " ", "not", " ", "block", " ", "any", " ", 
        "symbols"}], ",", " ", 
       RowBox[{
       "they", " ", "can", " ", "be", " ", "used", " ", "after", " ", 
        "words"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"mmConn", "=", 
       RowBox[{"OpenSQLConnection", "[", 
        RowBox[{"JDBC", "[", 
         RowBox[{"\"\<SQLite\>\"", ",", "mmpath"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"contConn", "=", 
       RowBox[{"OpenSQLConnection", "[", 
        RowBox[{"JDBC", "[", 
         RowBox[{"\"\<SQLite\>\"", ",", "contpath"}], "]"}], "]"}]}], ";", 
      RowBox[{"rawcontact", "=", 
       RowBox[{"SQLSelect", "[", 
        RowBox[{"contConn", ",", "\"\<Friend\>\""}], "]"}]}], ";", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"01", " ", "is", " ", "male"}], ",", " ", 
        RowBox[{"02", " ", "is", " ", "female"}], ",", " ", 
        RowBox[{"00", " ", "is", " ", "unknown"}]}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"contact", "=", 
       RowBox[{
        RowBox[{"readContact", "/@", 
         RowBox[{"rawcontact", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "8", ",", "10"}], "}"}]}], "]"}], "]"}]}], "//",
         "Quiet"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"chatID", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"\"\<Chat_\>\"", "<>", 
          RowBox[{"IntegerString", "[", 
           RowBox[{
            RowBox[{"Hash", "[", 
             RowBox[{"#", ",", "\"\<MD5\>\""}], "]"}], ",", "16", ",", "32"}],
            "]"}]}], "&"}], "/@", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Transpose", "[", "contact", "]"}], ")"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}]}], ";", 
      RowBox[{"getInfo", "=", 
       RowBox[{"AssociationThread", "[", 
        RowBox[{"chatID", ",", "contact"}], "]"}]}], ";", 
      RowBox[{"availChatID", "=", 
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{"SQLTableNames", "[", "mmConn", "]"}], ",", 
         RowBox[{
          RowBox[{"StringContainsQ", "[", 
           RowBox[{"#", ",", "\"\<Chat_\>\""}], "]"}], "&"}]}], "]"}]}], ";", 
      
      RowBox[{"availUserInfo", "=", 
       RowBox[{"Lookup", "[", 
        RowBox[{"getInfo", ",", "availChatID"}], "]"}]}], ";", 
      RowBox[{"chatData", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"SQLSelect", "[", 
            RowBox[{"mmConn", ",", "#"}], "]"}], "&"}], "/@", "availChatID"}],
          ")"}], "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "All", ",", 
          RowBox[{"{", 
           RowBox[{"4", ",", "5", ",", "9"}], "}"}]}], "]"}], "]"}]}], ";", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"since", " ", "order", " ", "is", " ", "preserved"}], ",", 
        " ", 
        RowBox[{
        "any", " ", "other", " ", "info", " ", "than", " ", "time", " ", "is",
          " ", "useless", " ", "for", " ", "counting"}], ",", " ", 
        RowBox[{"improves", " ", "performance"}]}], "*)"}], 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"but", " ", "to", " ", "analysis", " ", "contents"}], ",", 
        " ", 
        RowBox[{
        "use", " ", "full", " ", "database", " ", "chatData", " ", 
         "instead"}]}], "*)"}], 
      RowBox[{"chatTimeStamps", "=", 
       RowBox[{"chatData", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "All", ",", "1"}], "]"}], "]"}]}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "the", " ", "function", " ", "does", " ", "not", " ", "handle", " ", 
    "emoji", " ", "in", " ", "names", " ", "because", " ", "MMA", " ", "does",
     " ", "not", " ", "support", " ", "it"}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "shortest", " ", "pattern", " ", "to", " ", "match", " ", "username"}], 
    ",", " ", "nickname", ",", " ", "internalID", ",", " ", 
    RowBox[{"has", " ", "issues"}], ",", " ", 
    RowBox[{
    "eats", " ", "first", " ", "letter", " ", "of", " ", "user", " ", 
     "defined", " ", "ID", " ", "occasionally"}]}], "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{"readContact", "[", 
     RowBox[{"{", 
      RowBox[{"username_", ",", 
       RowBox[{"SQLBinary", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"Longest", "[", "x__", "]"}], "/;", 
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"{", "x", "}"}], "]"}], ">", "1"}]}], ",", "18", ",", 
          "y__", ",", "26", ",", "z__", ",", "34", ",", "___"}], "}"}], "]"}],
        ",", "profile_"}], "}"}], "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{"username", ",", 
      RowBox[{"Sequence", "@@", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"FromCharacterCode", "[", 
           RowBox[{"#", ",", "\"\<UTF-8\>\""}], "]"}], "&"}], "/@", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Drop", "[", 
            RowBox[{
             RowBox[{"{", "x", "}"}], ",", "2"}], "]"}], ",", 
           RowBox[{"Drop", "[", 
            RowBox[{
             RowBox[{"{", "y", "}"}], ",", "1"}], "]"}], ",", 
           RowBox[{"Drop", "[", 
            RowBox[{
             RowBox[{"{", "z", "}"}], ",", "1"}], "]"}]}], "}"}]}], ")"}]}], 
      ",", 
      RowBox[{"profile", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "}"}]}], 
   ";"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"readContact", "[", "___", "]"}], ":=", "Nothing"}], ";"}], "\n", 
  
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
     "the", " ", "time", " ", "stamp", " ", "is", " ", "the", " ", "second", 
      " ", "elapsed", " ", "from", " ", "1970"}], "-", "1", "-", 
     RowBox[{"1", " ", "8"}]}], ":", 
    RowBox[{"00", "AM", " ", 
     RowBox[{"(", 
      RowBox[{"GMT", "+", "8"}], ")"}]}]}], "*)"}], "\n", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"convert", " ", "time", " ", "to", " ", "date", " ", "string"}], 
    ",", " ", 
    RowBox[{"for", " ", "output"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"toDateString", "=", 
    RowBox[{
     RowBox[{"DateString", "@", 
      RowBox[{"AbsoluteTime", "[", 
       RowBox[{"2209017600", "+", "#"}], "]"}]}], "&"}]}], ";"}], "\n", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "convert", " ", "date", " ", "string", " ", "to", " ", "internal", " ", 
     "time"}], ",", " ", 
    RowBox[{"for", " ", "selection"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"toInternalTime", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"AbsoluteTime", "[", "#", "]"}], "-", "2209017600"}], "&"}]}], 
   ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"all", " ", "message", " ", "counts"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"topAllChatCounts", "[", "anydb_", "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"Transpose", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Length", "/@", "anydb"}], ",", "availUserInfo"}], "}"}], 
       "]"}], "//", "Sort"}], "//", "Reverse"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"note", ":", " ", 
    RowBox[{
    "be", " ", "aware", " ", "of", " ", "the", " ", "precedence", " ", "of", 
     " ", "the", " ", "Alternative", " ", "operator", " ", "in", " ", 
     "string", " ", "patterns"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"noGroups", "[", "countRes_", "]"}], ":=", 
    RowBox[{"countRes", "/.", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"__", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"_", "?", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"StringQ", "[", "#", "]"}], "&&", 
              RowBox[{"StringMatchQ", "[", 
               RowBox[{"#", ",", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"__", "~~", "\"\<@chatroom\>\""}], ")"}], "|", 
                 RowBox[{"(", 
                  RowBox[{"\"\<gh_\>\"", "~~", "__"}], ")"}]}]}], "]"}]}], 
             "&"}], ")"}]}], ",", "__"}], "}"}]}], "}"}], "\[RuleDelayed]", 
      "Nothing"}]}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"2.1", " ", 
    RowBox[{"new", ":", " ", 
     RowBox[{
     "displays", " ", "count", " ", "of", " ", "message", " ", "sent", " ", 
      "by", " ", "user", " ", "and", " ", "others", " ", "in", " ", "a", " ", 
      "chat"}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"0", " ", "represents", " ", "the", " ", "user"}], ",", " ", 
    RowBox[{"and", " ", "1", " ", "presents", " ", "other", 
     RowBox[{"(", "s", ")"}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"this", " ", "'"}], 
       RowBox[{"s", "'"}], " ", "refers", " ", "to", " ", "a", " ", "group", 
       " ", "chat"}], ")"}], " ", "in", " ", "a", " ", "chat"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "unlike", " ", "the", " ", "previous", " ", "count", " ", "functions"}], 
    ",", " ", 
    RowBox[{
    "this", " ", "functions", " ", "must", " ", "take", " ", "the", " ", 
     "full", " ", "chat", " ", "variable", " ", "as", " ", "the", " ", 
     "argument"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"topAllChatIndividualCounts", "[", "fulldb_", "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"Transpose", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Length", "/@", "fulldb"}], ",", 
         RowBox[{"Tally", "/@", 
          RowBox[{"fulldb", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "All", ",", 
             RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", "availUserInfo"}], 
        "}"}], "]"}], "//", "Sort"}], "//", "Reverse"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "performs", " ", "counting", " ", "over", " ", "a", " ", "specific", " ", 
    "time", " ", "range"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"function", " ", "takes", " ", "two", " ", "DateObjects"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"takeTimeStampRange", "[", 
    RowBox[{"timestampdb_", ",", "start_", ",", "end_"}], "]"}], ":=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"s", "=", 
        RowBox[{"toInternalTime", "[", "start", "]"}]}], ",", 
       RowBox[{"e", "=", 
        RowBox[{"toInternalTime", "[", "end", "]"}]}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"Select", "[", 
       RowBox[{
        RowBox[{"s", "\[LessEqual]", "#", "\[LessEqual]", "e"}], "&"}], "]"}],
       "/@", "timestampdb"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"takeTimeRange", "[", 
     RowBox[{"fulldb_", ",", "start_", ",", "end_"}], "]"}], ":=", 
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"s", "=", 
         RowBox[{"toInternalTime", "[", "start", "]"}]}], ",", 
        RowBox[{"e", "=", 
         RowBox[{"toInternalTime", "[", "end", "]"}]}]}], "}"}], ",", 
      RowBox[{
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{"s", "\[LessEqual]", 
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "\[LessEqual]", "e"}], "&"}], 
        "]"}], "/@", "fulldb"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"generate", " ", "a", " ", "random", " ", "time", " ", "range"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"randomDateRange", "[", "timestampdb_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"lowerlim", ",", "upperlim"}], "}"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"lowerlim", ",", "upperlim"}], "}"}], "=", 
        RowBox[{"MinMax", "@", 
         RowBox[{"Flatten", "@", "timestampdb"}]}]}], ";", 
       RowBox[{"DateObject", "/@", 
        RowBox[{"Sort", "@", 
         RowBox[{"RandomInteger", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{"lowerlim", ",", "upperlim"}], "}"}], "+", 
            "2209017600"}], ",", "2"}], "]"}]}]}]}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "get", " ", "chat", " ", "data", " ", "for", " ", "a", " ", "specfic", " ",
     "user", " ", "by", " ", "internalID"}], "*)"}]}], "\[IndentingNewLine]", 

 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"userChat", "[", 
     RowBox[{"fulldb_", ",", "id_String"}], "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Position", "[", 
        RowBox[{"availUserInfo", ",", "id"}], "]"}], "//", "Flatten"}], "//", 
      "First"}], "//", 
     RowBox[{
      RowBox[{"fulldb", "[", 
       RowBox[{"[", "#", "]"}], "]"}], "&"}]}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "distribution", " ", "of", " ", "messages", " ", "over", " ", "time"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"toTimeSeries", "[", 
     RowBox[{"singledb_", ",", 
      RowBox[{"period", ":", 
       RowBox[{"(", 
        RowBox[{"\"\<Week\>\"", "|", "\"\<Month\>\""}], ")"}]}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"firstDay", ",", "lastDay", ",", "timedomain", ",", "counts"}],
        "}"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"firstDay", ",", "lastDay"}], "}"}], "=", 
        RowBox[{"MinMax", "[", 
         RowBox[{
          RowBox[{"Flatten", "@", 
           RowBox[{"singledb", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "1"}], "]"}], "]"}]}], "+", "2209017600"}], 
         "]"}]}], ";", 
       RowBox[{"timedomain", "=", 
        RowBox[{"DateRange", "[", 
         RowBox[{
          RowBox[{"DateObject", "[", "firstDay", "]"}], ",", 
          RowBox[{"DateObject", "[", "lastDay", "]"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"1", ",", "period"}], "}"}]}], "]"}]}], ";", 
       RowBox[{"counts", "=", 
        RowBox[{
         RowBox[{"BinLists", "[", 
          RowBox[{
           RowBox[{"singledb", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"AbsoluteTime", "/@", "timedomain"}], "-", 
             "2209017600"}], "}"}]}], "]"}], "//", 
         RowBox[{
          RowBox[{"Length", "/@", "#"}], "&"}]}]}], ";", 
       RowBox[{"Transpose", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"timedomain", "[", 
           RowBox[{"[", 
            RowBox[{";;", 
             RowBox[{"-", "2"}]}], "]"}], "]"}], ",", "counts"}], "}"}], 
        "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"unfortunately", ",", " ", 
    RowBox[{
    "excel", " ", "format", " ", "does", " ", "not", " ", "have", " ", "that",
      " ", "may", " ", "rows", " ", "to", " ", "store", " ", "all", " ", 
     "chats"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Export", "[", 
    RowBox[{"\"\<chat_history.xlsx\>\"", ",", 
     RowBox[{"Thread", "[", 
      RowBox[{
       RowBox[{"availUserInfo", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "2"}], "]"}], "]"}], "\[Rule]", "chatData"}], 
      "]"}]}], "]"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"exportAllHistory", "[", "filename_", "]"}], ":=", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{"filename", ",", 
      RowBox[{"Join", "@@", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Level", "[", 
           RowBox[{"#", ",", 
            RowBox[{"{", 
             RowBox[{"-", "2"}], "}"}]}], "]"}], "&"}], "/@", 
         RowBox[{"Transpose", "[", 
          RowBox[{"{", 
           RowBox[{"availUserInfo", ",", 
            RowBox[{"MapAt", "[", 
             RowBox[{"toDateString", ",", 
              RowBox[{"chatData", "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "All", ",", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", "3", ",", "2"}], "}"}]}], "]"}], "]"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"All", ",", "All", ",", "1"}], "}"}]}], "]"}]}], "}"}],
           "]"}]}], ")"}]}]}], "]"}], "//", "AbsoluteTiming"}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.70719076926757*^9, 3.7071907922422953`*^9}, {
   3.707190835836342*^9, 3.707190836098971*^9}, 3.7071908899962807`*^9, {
   3.7071914034771852`*^9, 3.707191415909992*^9}, {3.707191707435927*^9, 
   3.707191713044466*^9}, {3.707191783196278*^9, 3.707191783857798*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"e3631668-d57d-4c2f-ab28-48ab1b883b58"],

Cell[TextData[StyleBox["Change the following paths to the two sqlite files \
according to README",
 FontColor->RGBColor[1, 0, 0]]], "Text",
 CellChangeTimes->{{3.6951371996403522`*^9, 3.695137228484659*^9}, {
  3.69513967459028*^9, 3.695139675944203*^9}, {3.7071908988721943`*^9, 
  3.707190900238657*^9}},ExpressionUUID->"c87a5c82-b1c0-461d-af71-\
4dbcf38a58a6"],

Cell["Run the following code to preprocess the chat database", "Text",
 CellChangeTimes->{{3.707190906611075*^9, 3.7071909279724007`*^9}},
 CellID->665306374,ExpressionUUID->"300e572b-20c1-4e4e-bc28-30cc0997b916"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
  "mmPath", "=", 
   "\"\</Users/vaporized/Desktop/wechat_backups/2017623_full/DB/MM.sqlite\>\"\
"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "contactPath", "=", 
   "\"\</Users/vaporized/Desktop/wechat_backups/2017623_full/DB/WCDB_Contact.\
sqlite\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{"loadWechatDatabase", "[", 
   RowBox[{"mmPath", ",", "contactPath"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.694869150161687*^9, 3.6948691553771763`*^9}, {
   3.694869281764926*^9, 3.694869336917783*^9}, {3.694869389796958*^9, 
   3.6948693994104013`*^9}, {3.707188090715621*^9, 3.70718809529806*^9}, 
   3.707190705971636*^9, {3.7071907664266644`*^9, 3.7071907958809032`*^9}, 
   3.707190832090664*^9, {3.707191235052765*^9, 3.707191437976952*^9}, {
   3.707191715004607*^9, 3.7071917157079973`*^9}, {3.70719178000984*^9, 
   3.7071917903738213`*^9}},
 CellLabel->"In[17]:=",ExpressionUUID->"d50c5fa1-8e61-4148-9975-06c30922aaeb"]
}, Open  ]],

Cell[CellGroupData[{

Cell["All message counts", "Subsection",
 CellChangeTimes->{{3.69513776490417*^9, 3.695137772724682*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"include", " ", "groups", " ", "and", " ", "subscriptions"}], ",",
     " ", 
    RowBox[{"first", " ", "20"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"top20All", "=", 
     RowBox[{
      RowBox[{"topAllChatCounts", "[", "chatTimeStamps", "]"}], "//", 
      RowBox[{
       RowBox[{"Take", "[", 
        RowBox[{"#", ",", 
         RowBox[{"UpTo", "[", "20", "]"}]}], "]"}], "&"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"for", " ", "privacy", " ", "reasons"}], ",", " ", 
     RowBox[{
     "only", " ", "message", " ", "counts", " ", "are", " ", "displayed", " ",
       "as", " ", "a", " ", "public", " ", 
      RowBox[{"example", ".", " ", "But"}], " ", "the", " ", "variable", " ", 
      "top20All", " ", "will", " ", "contain", " ", "all", " ", "infomation", 
      " ", "in", " ", "your", " ", "run"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"top20All", "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "1"}], "]"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.695129624670095*^9, 3.695129722398445*^9}, {
   3.695130797515345*^9, 3.695130839513812*^9}, {3.695137350915553*^9, 
   3.695137371671303*^9}, {3.695137628723757*^9, 3.69513768392915*^9}, {
   3.695137716921036*^9, 3.695137720586398*^9}, {3.695137798623498*^9, 
   3.69513783271628*^9}, 3.707188106633058*^9, {3.707189604077087*^9, 
   3.7071896049967947`*^9}, {3.707190274925593*^9, 3.707190276707181*^9}, 
   3.707190592330276*^9, {3.70719181069652*^9, 3.7071918123984222`*^9}, {
   3.707191842971796*^9, 3.707191845373104*^9}},
 CellLabel->"In[22]:=",ExpressionUUID->"bf0b41aa-e669-4f28-87c4-196388c9f984"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "87023", ",", "43647", ",", "35583", ",", "35516", ",", "27605", ",", 
   "25679", ",", "23447", ",", "19385", ",", "18863", ",", "18822", ",", 
   "18792", ",", "13894", ",", "13805", ",", "11480", ",", "10004", ",", 
   "7870", ",", "7071", ",", "6733", ",", "5628", ",", "5147"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.695129630730577*^9, 3.695129688106657*^9, 3.6951297230242233`*^9, 
   3.695130840358824*^9, 3.6951376844081583`*^9, 3.707188109998777*^9, {
   3.707189010875154*^9, 3.7071890249514027`*^9}, 3.7071896072920427`*^9, 
   3.7071902771005697`*^9, 3.7071905931514063`*^9, 3.70719180856164*^9, 
   3.7071918485108*^9},
 CellLabel->"Out[23]=",
 CellID->479160567,ExpressionUUID->"4aa8d903-9347-417c-83be-f17fe3136ece"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"include", " ", "groups", " ", "and", " ", "subscriptions"}], ",",
     " ", 
    RowBox[{"first", " ", "20"}], ",", " ", 
    RowBox[{"with", " ", "individual", " ", "message", " ", "counts"}]}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"0", " ", "represents", " ", "the", " ", "user"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"top20AllVerbose", "=", 
     RowBox[{
      RowBox[{"topAllChatIndividualCounts", "[", "chatData", "]"}], "//", 
      RowBox[{
       RowBox[{"Take", "[", 
        RowBox[{"#", ",", 
         RowBox[{"UpTo", "[", "20", "]"}]}], "]"}], "&"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"for", " ", "privacy", " ", "reasons"}], ",", " ", 
     RowBox[{
     "only", " ", "message", " ", "counts", " ", "are", " ", "displayed", " ",
       "as", " ", "a", " ", "public", " ", 
      RowBox[{"example", ".", " ", "But"}], " ", "the", " ", "variable", " ", 
      "top20All", " ", "will", " ", "contain", " ", "all", " ", "infomation", 
      " ", "in", " ", "your", " ", "run"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"top20AllVerbose", "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2"}], "}"}]}], "]"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.7071896551387243`*^9, 3.707189706172287*^9}, {
   3.707190279879333*^9, 3.70719028164219*^9}, {3.70719031440414*^9, 
   3.7071903153529177`*^9}, 3.707190606177649*^9, {3.707191851561977*^9, 
   3.7071918591958647`*^9}},
 CellLabel->"In[24]:=",
 CellID->1695817538,ExpressionUUID->"dcd6b3bb-4896-46f6-96af-5d12d44b9d70"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"87023", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "53758"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "33265"}], "}"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"43647", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "24031"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "19616"}], "}"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"35583", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "18119"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "17464"}], "}"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"35516", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "15568"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "19948"}], "}"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"27605", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "26797"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "808"}], "}"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"25679", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "12091"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "13588"}], "}"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"23447", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "13182"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "10265"}], "}"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"19385", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "8981"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "10404"}], "}"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"18863", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "10005"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "8858"}], "}"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"18822", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "18761"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "61"}], "}"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"18792", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "7835"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "10957"}], "}"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"13894", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "8919"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "4975"}], "}"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"13805", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "7982"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "5823"}], "}"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"11480", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "6216"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "5264"}], "}"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"10004", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "9973"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "31"}], "}"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"7870", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "4266"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "3604"}], "}"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"7071", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "5332"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1739"}], "}"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"6733", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "3519"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "3214"}], "}"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"5628", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "5033"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "595"}], "}"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"5147", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "4133"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1014"}], "}"}]}], "}"}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.707189683046694*^9, 3.7071896895007267`*^9}, 
   3.707190282037189*^9, 3.707190315878634*^9, 3.707190607136405*^9, 
   3.7071918596856117`*^9},
 CellLabel->"Out[25]=",
 CellID->1922134355,ExpressionUUID->"55aefe11-b8e6-4e56-8634-b0a8e93f9006"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"exclude", " ", "groups", " ", "and", " ", "subscriptions"}], ",",
     " ", 
    RowBox[{"first", " ", "20"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"top20", "=", 
     RowBox[{
      RowBox[{"noGroups", "@", 
       RowBox[{"topAllChatCounts", "[", "chatTimeStamps", "]"}]}], "//", 
      RowBox[{
       RowBox[{"Take", "[", 
        RowBox[{"#", ",", 
         RowBox[{"UpTo", "[", "20", "]"}]}], "]"}], "&"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"message", " ", "counts", " ", "only"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"top20", "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "1"}], "]"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.695129726833709*^9, 3.695129737407872*^9}, {
   3.695129817141243*^9, 3.695129817340129*^9}, {3.6951298743817673`*^9, 
   3.6951298750451736`*^9}, {3.695130063317978*^9, 3.695130064634129*^9}, {
   3.695130853159226*^9, 3.695130908370232*^9}, {3.695131373925045*^9, 
   3.695131401546733*^9}, {3.695131471551511*^9, 3.695131518423498*^9}, {
   3.6951315526410646`*^9, 3.695131554434309*^9}, 3.695137382256225*^9, {
   3.695137689332375*^9, 3.695137702206996*^9}, {3.695137785481742*^9, 
   3.69513779356737*^9}, {3.695138133341999*^9, 3.695138148485141*^9}, 
   3.707188144354851*^9, {3.707189614118626*^9, 3.707189644908762*^9}, {
   3.707190289819253*^9, 3.7071902914616203`*^9}},
 CellLabel->"In[26]:=",ExpressionUUID->"87be7e43-ac51-4c45-b742-b91355f9a79e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "43647", ",", "35583", ",", "35516", ",", "25679", ",", "23447", ",", 
   "19385", ",", "18863", ",", "13805", ",", "11480", ",", "6733", ",", 
   "4228", ",", "3557", ",", "3169", ",", "2970", ",", "2558", ",", "2124", 
   ",", "2073", ",", "1859", ",", "1680", ",", "1516"}], "}"}]], "Output",
 CellChangeTimes->{
  3.695129875378829*^9, 3.695130066939149*^9, 3.695130908750149*^9, 
   3.695131402011862*^9, {3.6951315404975348`*^9, 3.6951315549802227`*^9}, 
   3.695137702857897*^9, 3.707188144807519*^9, 3.707189619429819*^9, 
   3.707190291860714*^9, 3.707190609916678*^9, 3.707191864070053*^9},
 CellLabel->"Out[27]=",
 CellID->1314082559,ExpressionUUID->"60b1dbed-c2a7-4049-af5c-82aa64ae7dc1"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Message counts over a certain time range", "Subsection",
 CellChangeTimes->{{3.695137851036769*^9, 3.69513786395257*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "generate", " ", "a", " ", "random", " ", "time", " ", "interval"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"date1", ",", "date2"}], "}"}], "=", 
    RowBox[{"randomDateRange", "[", "chatTimeStamps", "]"}]}], 
   ";"}]}]], "Input",
 CellChangeTimes->{{3.695131261729385*^9, 3.6951313097073936`*^9}, {
  3.695137887351881*^9, 3.6951379017321453`*^9}},
 CellLabel->
  "In[121]:=",ExpressionUUID->"c14db001-879e-457c-b5fb-dfeb5ae8f62f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"in", " ", "practice"}], ",", " ", 
    RowBox[{
    "you", " ", "may", " ", "want", " ", "to", " ", "specify", " ", "a", " ", 
     "time", " ", "range", " ", "manually"}], ",", " ", 
    RowBox[{
    "here", " ", "is", " ", "how", " ", "to", " ", "do", " ", "it"}]}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
     "suppose", " ", "you", " ", "want", " ", "the", " ", "start", " ", 
      "date", " ", 
      RowBox[{"(", 
       RowBox[{"date1", " ", "variable"}], ")"}], " ", "to", " ", "be", " ", 
      "2016"}], "-", "08", "-", "17"}], ",", " ", 
    RowBox[{"you", " ", "can", " ", "do"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"date1", "=", 
   RowBox[{"DateObject", "[", "\"\<2016-08-17\>\"", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.695137918488144*^9, 3.6951379812181177`*^9}, {
  3.695138017031464*^9, 3.6951380171753798`*^9}, {3.695138066364463*^9, 
  3.695138092593885*^9}},ExpressionUUID->"d8f99686-e904-493e-9789-\
f84d79c9e255"],

Cell[BoxData[
 TemplateBox[{RowBox[{"\"Wed 17 Aug 2016\""}],RowBox[{"DateObject", "[", 
     RowBox[{"{", 
       RowBox[{"2016", ",", "8", ",", "17"}], "}"}], "]"}]},
  "DateObject",
  Editable->False]], "Output",
 CellChangeTimes->{
  3.695138085520974*^9},ExpressionUUID->"432c1a54-f8e5-4c82-abe7-\
687157da45a0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"specify", " ", "a", " ", "date"}], ",", " ", 
    RowBox[{"to", " ", "today"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"partialChatTimeStamp", "=", 
     RowBox[{"takeTimeStampRange", "[", 
      RowBox[{"chatTimeStamps", ",", 
       RowBox[{"DateObject", "[", "\"\<2017-04-01\>\"", "]"}], ",", "Today"}],
       "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"top20partialts", "=", 
     RowBox[{
      RowBox[{"noGroups", "@", 
       RowBox[{"topAllChatCounts", "[", "partialChatTimeStamp", "]"}]}], "//", 
      RowBox[{
       RowBox[{"Take", "[", 
        RowBox[{"#", ",", 
         RowBox[{"UpTo", "[", "20", "]"}]}], "]"}], "&"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"individual", " ", "counts"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"partialChat", "=", 
     RowBox[{"takeTimeRange", "[", 
      RowBox[{"chatData", ",", 
       RowBox[{"DateObject", "[", "\"\<2017-04-01\>\"", "]"}], ",", "Today"}],
       "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"top20partial", "=", 
     RowBox[{
      RowBox[{"noGroups", "@", 
       RowBox[{"topAllChatIndividualCounts", "[", "partialChat", "]"}]}], "//", 
      RowBox[{
       RowBox[{"Take", "[", 
        RowBox[{"#", ",", 
         RowBox[{"UpTo", "[", "20", "]"}]}], "]"}], "&"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"top20partial", "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2"}], "}"}]}], "]"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.695130776070773*^9, 3.695130781484911*^9}, {
   3.695130925300747*^9, 3.6951310134052773`*^9}, {3.6951313313928423`*^9, 
   3.695131336898121*^9}, {3.69513803393381*^9, 3.695138056404091*^9}, {
   3.6951381187798653`*^9, 3.6951381208525267`*^9}, 3.695138154405555*^9, {
   3.707189754590597*^9, 3.707189870399034*^9}, {3.7071899589313183`*^9, 
   3.707189977587268*^9}, {3.707190016422923*^9, 3.70719006764784*^9}, {
   3.707190298634446*^9, 3.707190308800064*^9}, {3.707190346080864*^9, 
   3.707190383369957*^9}, 3.707190629547227*^9, {3.707191871226665*^9, 
   3.7071918788897867`*^9}},
 CellLabel->"In[33]:=",ExpressionUUID->"1ad33aa7-9466-4fa0-828b-000763a47643"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"33664", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "17196"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "16468"}], "}"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4710", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "2182"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "2528"}], "}"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3594", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "1944"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1650"}], "}"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1727", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "1007"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "720"}], "}"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"860", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "441"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "419"}], "}"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"699", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "440"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "259"}], "}"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"483", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "229"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "254"}], "}"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"469", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "268"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "201"}], "}"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"267", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "177"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "90"}], "}"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"239", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "135"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "104"}], "}"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"201", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "120"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "81"}], "}"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"144", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "70"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "74"}], "}"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"131", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "50"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "81"}], "}"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"127", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "69"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "58"}], "}"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"85", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "44"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "41"}], "}"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"85", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "40"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "45"}], "}"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"82", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "43"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "39"}], "}"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"65", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "37"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "28"}], "}"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"64", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "27"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "37"}], "}"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"59", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "31"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "28"}], "}"}]}], "}"}]}], "}"}]}], "}"}]], "Output",\

 CellChangeTimes->{
  3.7071901962497253`*^9, 3.707190245533012*^9, {3.707190359871909*^9, 
   3.707190384263833*^9}, {3.7071906270386353`*^9, 3.7071906306050987`*^9}, {
   3.70719187388338*^9, 3.70719187978096*^9}},
 CellLabel->"Out[37]=",
 CellID->1770324310,ExpressionUUID->"2e8544d1-1d38-4fc2-b3ee-b2c2e13a701d"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Analysis a single person", "Subsection",
 CellChangeTimes->{{3.695138169635913*^9, 3.695138173364002*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "place", " ", "the", " ", "wechat", " ", "id", " ", "you", " ", "want", 
     " ", "to", " ", "analysis", " ", "here"}], ",", " ", 
    RowBox[{
     RowBox[{"it", " ", "is", " ", "of", " ", "form", " ", "wxid_XXX"}], 
     "..."}], ",", " ", 
    RowBox[{
    "you", " ", "can", " ", "get", " ", "such", " ", "information", " ", "by",
      " ", "evaluating", " ", "`availUserInfo`"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"testid", "=", "\"\<wxid_XXXXXXXXXXXXXXX\>\""}], ";"}]}]], "Input",\

 CellChangeTimes->{{3.6951319598685637`*^9, 3.695131966034381*^9}, 
   3.695138219524315*^9, {3.6951382579823914`*^9, 3.6951383224495897`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "You", " ", "can", " ", "perform", " ", "either", " ", "a", " ", "week", 
     " ", "or", " ", "a", " ", "month", " ", "summation"}], ",", " ", 
    RowBox[{"by", " ", "altering", " ", "that", " ", 
     RowBox[{"\"\<Week\>\"", "/", "\"\<Month\>\""}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"in", " ", "this", " ", "picture"}], ",", " ", 
    RowBox[{"every", " ", "datapoint", 
     RowBox[{"(", 
      RowBox[{"although", " ", "they", " ", "are", " ", "connected"}], ")"}], 
     " ", "is", " ", "a", " ", "summation", " ", "of", " ", "week"}], ",", 
    " ", 
    RowBox[{
    "the", " ", "connection", " ", "only", " ", "shows", " ", "the", " ", 
     "trend"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"DateListPlot", "[", 
   RowBox[{
    RowBox[{"toTimeSeries", "[", 
     RowBox[{
      RowBox[{"userChat", "[", 
       RowBox[{"chatData", ",", "testid"}], "]"}], ",", "\"\<Week\>\""}], 
     "]"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
    RowBox[{"DateTicksFormat", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
      "\"\<Month\>\"", ",", " ", "\"\</\>\"", ",", " ", "\"\<YearShort\>\""}],
       "}"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6951339103004093`*^9, 3.695133920255316*^9}, {
   3.695138217825488*^9, 3.695138224989408*^9}, {3.6951383287190437`*^9, 
   3.6951384018980913`*^9}, {3.695138537513295*^9, 3.695138538297524*^9}, {
   3.695138572739946*^9, 3.6951385778298903`*^9}, {3.695138611226177*^9, 
   3.695138615828775*^9}, 3.695138776464408*^9, {3.695139021873262*^9, 
   3.695139033466921*^9}, {3.695139070406526*^9, 3.695139172034671*^9}, {
   3.6951396255344553`*^9, 3.695139626416439*^9}}],

Cell[BoxData[
 GraphicsBox[{{}, {{}, {}, 
    {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.009166666666666668], 
     AbsoluteThickness[1.6], LineBox[CompressedData["
1:eJxVlMlPU1EUh59o6swYK2pUQChIHDDQUsShihYs8+BjxlKkqYJ2gmqMUSNY
wD8ARxJXjXFEF10qTt07Vd2xeiq4cEVUEOQe7i/xLJr2y7n33POdc3tTHe6a
zhhFUbrmP+JbUcb1T6cnDtBPJdkyz84vM2CKh5VZxrqsOcZqpTL5P4cCixhP
jcSAG0R+65vFLD78Ywk4W8S1JB04V7CpcClbH3QsYxwdWg42iPWGJytYPPB5
JePI3CrG+sxYxs6KOMbh3njGupEEyXfaxXnq60TJY3bBockkrDcJnkpcA84j
/9167t++lrE2mMzYNLqO+39az/1nNzA2GDZy//JN3L9nM/e/nQKuEPU5X6VK
vlQlODyRBrYK1iWms/1qQYbkcQf52w3oRzP5D2Qi7iT/x1mS7R2Ch6NbsZ7u
h/Y3G/0NCDZlbMP+AcHBsu2Sf/YIjvp3YP9pwYZbO1Fvq+DAyxzkOyc48n2X
ZHOfYH1CruTRs+RvzsN6mmf4mBG+LeQ/YJL866pg9VG+5IYg+X80I9958p8p
AHvJP71Qcryf/Ev3SPZQPs23F/05Q/4390nO8ZD/i/3wpXqj3yyor4j84w8i
3kT++UWSUy6Tf9sh9NNN/sHD6Fc1+T+0Iu4i/w/Fki115D9TgvhF8t9iw/k0
35CtFPU7yN9bxv4f1hvlyFdP/mMVkqsukP/XSsmufvKPq0b9VG/QVMPmFW2t
Rf8Hyf9KneS7xIEHR3E+9TvyXsV+6q9+uh7+3eSf1oj6aN7hI03sfdJ5m8Ft
5H+9Bb6d5P+8FflU8tfaMO+F+cfaEad+DhvbwT7yb3Hw+9/fgfOKyf/+cTDV
H33XCbaR/x8nm2cg1cXuR6TkBPxqyd9zkt1357Uu9IvqCz/r5u+fdgr76f+l
rnYjTu9DKM8DNpJ/s5e9H9Y+H3hh/vf87HztbQ/ijeT/uxf1uCz/AMZYuz4=

      "]]}}, {}, {}, {{}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{False, False},
  AxesLabel->{None, None},
  AxesOrigin->{3.621621943*^9, 0},
  DisplayFunction->Identity,
  Frame->{{True, True}, {True, True}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->
   FrontEndValueCache[{{Automatic, Automatic}, {Charting`FindScaledTicks[
       (Charting`getDateTicks[Automatic, {"Month", "/", "YearShort"}, 
        (Map[DateList, {
          SlotSequence[1]}]& )[
         SlotSequence[1]], None, 5, {{0.0125, 0}, {0.0075, 0}}, Automatic]& )[
       
        SlotSequence[1]], {Identity, Identity}]& , Charting`ScaledFrameTicks[
       (Charting`getDateTicks[
       Charting`getDateTicks[Automatic, {"Month", "/", "YearShort"}, 
         (Map[DateList, {
           SlotSequence[1]}]& )[
          SlotSequence[1]], None, 5, {{0.0125, 0}, {0.0075, 0}}, 
         Automatic]& , {"Month", "/", "YearShort"}, 
        (Map[DateList, {
          SlotSequence[1]}]& )[
         SlotSequence[1]], None, 5, {{0.0125, 0}, {0.0075, 0}}, None]& )[
        SlotSequence[1]], {Identity, Identity}]& }}, {{
     Automatic, Automatic}, {{{3.6131616*^9, 
        FormBox["\"07/14\"", TraditionalForm], {0.008333333333333333, 0.}}, {
       3.6290592*^9, 
        FormBox["\"01/15\"", TraditionalForm], {0.008333333333333333, 0.}}, {
       3.6446976*^9, 
        FormBox["\"07/15\"", TraditionalForm], {0.008333333333333333, 0.}}, {
       3.6605952*^9, 
        FormBox["\"01/16\"", TraditionalForm], {0.008333333333333333, 0.}}, {
       3.67632*^9, 
        FormBox["\"07/16\"", TraditionalForm], {0.008333333333333333, 0.}}, {
       3.6922176*^9, 
        FormBox["\"01/17\"", TraditionalForm], {0.008333333333333333, 0.}}, {
       3.6185184*^9, 
        FormBox[
         InterpretationBox[
          StyleBox[
           
           GraphicsBox[{}, ImageSize -> {0., 0.}, BaselinePosition -> 
            Baseline], "CacheGraphics" -> False], 
          Spacer[{0., 0.}]], TraditionalForm], {0.008333333333333333, 0.}}, {
       3.6237888*^9, 
        FormBox[
         InterpretationBox[
          StyleBox[
           
           GraphicsBox[{}, ImageSize -> {0., 0.}, BaselinePosition -> 
            Baseline], "CacheGraphics" -> False], 
          Spacer[{0., 0.}]], TraditionalForm], {0.008333333333333333, 0.}}, {
       3.6341568*^9, 
        FormBox[
         InterpretationBox[
          StyleBox[
           
           GraphicsBox[{}, ImageSize -> {0., 0.}, BaselinePosition -> 
            Baseline], "CacheGraphics" -> False], 
          Spacer[{0., 0.}]], TraditionalForm], {0.008333333333333333, 0.}}, {
       3.6394272*^9, 
        FormBox[
         InterpretationBox[
          StyleBox[
           
           GraphicsBox[{}, ImageSize -> {0., 0.}, BaselinePosition -> 
            Baseline], "CacheGraphics" -> False], 
          Spacer[{0., 0.}]], TraditionalForm], {0.008333333333333333, 0.}}, {
       3.6500544*^9, 
        FormBox[
         InterpretationBox[
          StyleBox[
           
           GraphicsBox[{}, ImageSize -> {0., 0.}, BaselinePosition -> 
            Baseline], "CacheGraphics" -> False], 
          Spacer[{0., 0.}]], TraditionalForm], {0.008333333333333333, 0.}}, {
       3.6553248*^9, 
        FormBox[
         InterpretationBox[
          StyleBox[
           
           GraphicsBox[{}, ImageSize -> {0., 0.}, BaselinePosition -> 
            Baseline], "CacheGraphics" -> False], 
          Spacer[{0., 0.}]], TraditionalForm], {0.008333333333333333, 0.}}, {
       3.6657792*^9, 
        FormBox[
         InterpretationBox[
          StyleBox[
           
           GraphicsBox[{}, ImageSize -> {0., 0.}, BaselinePosition -> 
            Baseline], "CacheGraphics" -> False], 
          Spacer[{0., 0.}]], TraditionalForm], {0.008333333333333333, 0.}}, {
       3.6710496*^9, 
        FormBox[
         InterpretationBox[
          StyleBox[
           
           GraphicsBox[{}, ImageSize -> {0., 0.}, BaselinePosition -> 
            Baseline], "CacheGraphics" -> False], 
          Spacer[{0., 0.}]], TraditionalForm], {0.008333333333333333, 0.}}, {
       3.6816768*^9, 
        FormBox[
         InterpretationBox[
          StyleBox[
           
           GraphicsBox[{}, ImageSize -> {0., 0.}, BaselinePosition -> 
            Baseline], "CacheGraphics" -> False], 
          Spacer[{0., 0.}]], TraditionalForm], {0.008333333333333333, 0.}}, {
       3.6869472*^9, 
        FormBox[
         InterpretationBox[
          StyleBox[
           
           GraphicsBox[{}, ImageSize -> {0., 0.}, BaselinePosition -> 
            Baseline], "CacheGraphics" -> False], 
          Spacer[{0., 0.}]], TraditionalForm], {0.008333333333333333, 
        0.}}}, {{3.6131616*^9, 
        FormBox[
         InterpretationBox[
          StyleBox[
           
           GraphicsBox[{}, ImageSize -> {0., 0.}, BaselinePosition -> 
            Baseline], "CacheGraphics" -> False], 
          Spacer[{0., 0.}]], TraditionalForm], {0.008333333333333333, 0.}}, {
       3.6290592*^9, 
        FormBox[
         InterpretationBox[
          StyleBox[
           
           GraphicsBox[{}, ImageSize -> {0., 0.}, BaselinePosition -> 
            Baseline], "CacheGraphics" -> False], 
          Spacer[{0., 0.}]], TraditionalForm], {0.008333333333333333, 0.}}, {
       3.6446976*^9, 
        FormBox[
         InterpretationBox[
          StyleBox[
           
           GraphicsBox[{}, ImageSize -> {0., 0.}, BaselinePosition -> 
            Baseline], "CacheGraphics" -> False], 
          Spacer[{0., 0.}]], TraditionalForm], {0.008333333333333333, 0.}}, {
       3.6605952*^9, 
        FormBox[
         InterpretationBox[
          StyleBox[
           
           GraphicsBox[{}, ImageSize -> {0., 0.}, BaselinePosition -> 
            Baseline], "CacheGraphics" -> False], 
          Spacer[{0., 0.}]], TraditionalForm], {0.008333333333333333, 0.}}, {
       3.67632*^9, 
        FormBox[
         InterpretationBox[
          StyleBox[
           
           GraphicsBox[{}, ImageSize -> {0., 0.}, BaselinePosition -> 
            Baseline], "CacheGraphics" -> False], 
          Spacer[{0., 0.}]], TraditionalForm], {0.008333333333333333, 0.}}, {
       3.6922176*^9, 
        FormBox[
         InterpretationBox[
          StyleBox[
           
           GraphicsBox[{}, ImageSize -> {0., 0.}, BaselinePosition -> 
            Baseline], "CacheGraphics" -> False], 
          Spacer[{0., 0.}]], TraditionalForm], {0.008333333333333333, 0.}}, {
       3.6185184*^9, 
        FormBox[
         InterpretationBox[
          StyleBox[
           
           GraphicsBox[{}, ImageSize -> {0., 0.}, BaselinePosition -> 
            Baseline], "CacheGraphics" -> False], 
          Spacer[{0., 0.}]], TraditionalForm], {0.008333333333333333, 0.}}, {
       3.6237888*^9, 
        FormBox[
         InterpretationBox[
          StyleBox[
           
           GraphicsBox[{}, ImageSize -> {0., 0.}, BaselinePosition -> 
            Baseline], "CacheGraphics" -> False], 
          Spacer[{0., 0.}]], TraditionalForm], {0.008333333333333333, 0.}}, {
       3.6341568*^9, 
        FormBox[
         InterpretationBox[
          StyleBox[
           
           GraphicsBox[{}, ImageSize -> {0., 0.}, BaselinePosition -> 
            Baseline], "CacheGraphics" -> False], 
          Spacer[{0., 0.}]], TraditionalForm], {0.008333333333333333, 0.}}, {
       3.6394272*^9, 
        FormBox[
         InterpretationBox[
          StyleBox[
           
           GraphicsBox[{}, ImageSize -> {0., 0.}, BaselinePosition -> 
            Baseline], "CacheGraphics" -> False], 
          Spacer[{0., 0.}]], TraditionalForm], {0.008333333333333333, 0.}}, {
       3.6500544*^9, 
        FormBox[
         InterpretationBox[
          StyleBox[
           
           GraphicsBox[{}, ImageSize -> {0., 0.}, BaselinePosition -> 
            Baseline], "CacheGraphics" -> False], 
          Spacer[{0., 0.}]], TraditionalForm], {0.008333333333333333, 0.}}, {
       3.6553248*^9, 
        FormBox[
         InterpretationBox[
          StyleBox[
           
           GraphicsBox[{}, ImageSize -> {0., 0.}, BaselinePosition -> 
            Baseline], "CacheGraphics" -> False], 
          Spacer[{0., 0.}]], TraditionalForm], {0.008333333333333333, 0.}}, {
       3.6657792*^9, 
        FormBox[
         InterpretationBox[
          StyleBox[
           
           GraphicsBox[{}, ImageSize -> {0., 0.}, BaselinePosition -> 
            Baseline], "CacheGraphics" -> False], 
          Spacer[{0., 0.}]], TraditionalForm], {0.008333333333333333, 0.}}, {
       3.6710496*^9, 
        FormBox[
         InterpretationBox[
          StyleBox[
           
           GraphicsBox[{}, ImageSize -> {0., 0.}, BaselinePosition -> 
            Baseline], "CacheGraphics" -> False], 
          Spacer[{0., 0.}]], TraditionalForm], {0.008333333333333333, 0.}}, {
       3.6816768*^9, 
        FormBox[
         InterpretationBox[
          StyleBox[
           
           GraphicsBox[{}, ImageSize -> {0., 0.}, BaselinePosition -> 
            Baseline], "CacheGraphics" -> False], 
          Spacer[{0., 0.}]], TraditionalForm], {0.008333333333333333, 0.}}, {
       3.6869472*^9, 
        FormBox[
         InterpretationBox[
          StyleBox[
           
           GraphicsBox[{}, ImageSize -> {0., 0.}, BaselinePosition -> 
            Baseline], "CacheGraphics" -> False], 
          Spacer[{0., 0.}]], TraditionalForm], {0.008333333333333333, 0.}}}}}],
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImagePadding->All,
  Method->{"CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
         Part[#, 1]], 
        (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
         Part[#, 1]], 
        (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
         Part[#, 2]]}& )}},
  PlotRange->{{3.621621943*^9, 3.685730743*^9}, {0, 863.}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.02], 
     Scaled[0.05]}},
  Ticks->{{}, Automatic}]], "Output",
 CellChangeTimes->{3.695138578295636*^9, 3.6951386169896593`*^9, 
  3.695139034542306*^9, 3.695139076795433*^9, 3.695139126113159*^9, 
  3.69513917429272*^9, 3.695139627090625*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "if", " ", "you", " ", "are", " ", "not", " ", "comfortable", " ", "with",
      " ", "the", " ", "plot", " ", "above"}], ",", " ", 
    RowBox[{"here", " ", "is", " ", "another", " ", "option"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"DateHistogram", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"userChat", "[", 
       RowBox[{"chatData", ",", "testid"}], "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "1"}], "]"}], "]"}], "+", "2209017600"}], ",", 
    "\"\<Week\>\""}], "]"}]}]], "Input",
 CellChangeTimes->{{3.695139176450635*^9, 3.6951392028339148`*^9}}],

Cell[BoxData[
 GraphicsBox[{
   {RGBColor[0.987148, 0.8073604000000001, 0.49470040000000004`], EdgeForm[
    Opacity[0.]], {}, 
    {RGBColor[0.987148, 0.8073604000000001, 0.49470040000000004`], EdgeForm[
     Opacity[0.]], RectangleBox[{3.6215424*^9, 0}, {3.6221472*^9, 6},
      RoundingRadius->0], RectangleBox[{3.6251712*^9, 0}, {3.625776*^9, 96},
      RoundingRadius->0], RectangleBox[{3.6263808*^9, 0}, {3.6269856*^9, 13},
      RoundingRadius->0], RectangleBox[{3.6269856*^9, 0}, {3.6275904*^9, 19},
      RoundingRadius->0], RectangleBox[{3.6288*^9, 0}, {3.6294048*^9, 11},
      RoundingRadius->0], 
     RectangleBox[{3.6330336*^9, 0}, {3.6336384*^9, 141},
      RoundingRadius->0], 
     RectangleBox[{3.6336384*^9, 0}, {3.6342432*^9, 134},
      RoundingRadius->0], RectangleBox[{3.6342432*^9, 0}, {3.634848*^9, 22},
      RoundingRadius->0], RectangleBox[{3.634848*^9, 0}, {3.6354528*^9, 20},
      RoundingRadius->0], RectangleBox[{3.640896*^9, 0}, {3.6415008*^9, 60},
      RoundingRadius->0], RectangleBox[{3.6415008*^9, 0}, {3.6421056*^9, 66},
      RoundingRadius->0], RectangleBox[{3.6421056*^9, 0}, {3.6427104*^9, 45},
      RoundingRadius->0], RectangleBox[{3.6433152*^9, 0}, {3.64392*^9, 151},
      RoundingRadius->0], RectangleBox[{3.64392*^9, 0}, {3.6445248*^9, 111},
      RoundingRadius->0], 
     RectangleBox[{3.6445248*^9, 0}, {3.6451296*^9, 152},
      RoundingRadius->0], 
     RectangleBox[{3.6451296*^9, 0}, {3.6457344*^9, 186},
      RoundingRadius->0], RectangleBox[{3.6457344*^9, 0}, {3.6463392*^9, 99},
      RoundingRadius->0], RectangleBox[{3.6463392*^9, 0}, {3.646944*^9, 282},
      RoundingRadius->0], RectangleBox[{3.646944*^9, 0}, {3.6475488*^9, 781},
      RoundingRadius->0], 
     RectangleBox[{3.6475488*^9, 0}, {3.6481536*^9, 398},
      RoundingRadius->0], 
     RectangleBox[{3.6481536*^9, 0}, {3.6487584*^9, 229},
      RoundingRadius->0], 
     RectangleBox[{3.6487584*^9, 0}, {3.6493632*^9, 117},
      RoundingRadius->0], RectangleBox[{3.6493632*^9, 0}, {3.649968*^9, 331},
      RoundingRadius->0], RectangleBox[{3.649968*^9, 0}, {3.6505728*^9, 585},
      RoundingRadius->0], 
     RectangleBox[{3.6505728*^9, 0}, {3.6511776*^9, 499},
      RoundingRadius->0], 
     RectangleBox[{3.6511776*^9, 0}, {3.6517824*^9, 172},
      RoundingRadius->0], 
     RectangleBox[{3.6517824*^9, 0}, {3.6523872*^9, 105},
      RoundingRadius->0], RectangleBox[{3.6523872*^9, 0}, {3.652992*^9, 645},
      RoundingRadius->0], RectangleBox[{3.652992*^9, 0}, {3.6535968*^9, 901},
      RoundingRadius->0], 
     RectangleBox[{3.6535968*^9, 0}, {3.6542016*^9, 423},
      RoundingRadius->0], 
     RectangleBox[{3.6542016*^9, 0}, {3.6548064*^9, 334},
      RoundingRadius->0], 
     RectangleBox[{3.6548064*^9, 0}, {3.6554112*^9, 298},
      RoundingRadius->0], RectangleBox[{3.6554112*^9, 0}, {3.656016*^9, 863},
      RoundingRadius->0], RectangleBox[{3.656016*^9, 0}, {3.6566208*^9, 373},
      RoundingRadius->0], 
     RectangleBox[{3.6566208*^9, 0}, {3.6572256*^9, 246},
      RoundingRadius->0], 
     RectangleBox[{3.6572256*^9, 0}, {3.6578304*^9, 348},
      RoundingRadius->0], RectangleBox[{3.6578304*^9, 0}, {3.6584352*^9, 90},
      RoundingRadius->0], RectangleBox[{3.6584352*^9, 0}, {3.65904*^9, 60},
      RoundingRadius->0], RectangleBox[{3.65904*^9, 0}, {3.6596448*^9, 651},
      RoundingRadius->0], 
     RectangleBox[{3.6596448*^9, 0}, {3.6602496*^9, 255},
      RoundingRadius->0], RectangleBox[{3.6602496*^9, 0}, {3.6608544*^9, 68},
      RoundingRadius->0], 
     RectangleBox[{3.6608544*^9, 0}, {3.6614592*^9, 181},
      RoundingRadius->0], RectangleBox[{3.6614592*^9, 0}, {3.662064*^9, 98},
      RoundingRadius->0], RectangleBox[{3.662064*^9, 0}, {3.6626688*^9, 417},
      RoundingRadius->0], 
     RectangleBox[{3.6626688*^9, 0}, {3.6632736*^9, 269},
      RoundingRadius->0], 
     RectangleBox[{3.6632736*^9, 0}, {3.6638784*^9, 104},
      RoundingRadius->0], 
     RectangleBox[{3.6638784*^9, 0}, {3.6644832*^9, 180},
      RoundingRadius->0], RectangleBox[{3.6644832*^9, 0}, {3.665088*^9, 86},
      RoundingRadius->0], RectangleBox[{3.665088*^9, 0}, {3.6656928*^9, 485},
      RoundingRadius->0], 
     RectangleBox[{3.6656928*^9, 0}, {3.6662976*^9, 590},
      RoundingRadius->0], 
     RectangleBox[{3.6662976*^9, 0}, {3.6669024*^9, 243},
      RoundingRadius->0], 
     RectangleBox[{3.6669024*^9, 0}, {3.6675072*^9, 455},
      RoundingRadius->0], RectangleBox[{3.6675072*^9, 0}, {3.668112*^9, 597},
      RoundingRadius->0], RectangleBox[{3.668112*^9, 0}, {3.6687168*^9, 952},
      RoundingRadius->0], 
     RectangleBox[{3.6687168*^9, 0}, {3.6693216*^9, 235},
      RoundingRadius->0], 
     RectangleBox[{3.6693216*^9, 0}, {3.6699264*^9, 468},
      RoundingRadius->0], 
     RectangleBox[{3.6699264*^9, 0}, {3.6705312*^9, 241},
      RoundingRadius->0], RectangleBox[{3.6705312*^9, 0}, {3.671136*^9, 64},
      RoundingRadius->0], RectangleBox[{3.671136*^9, 0}, {3.6717408*^9, 76},
      RoundingRadius->0], RectangleBox[{3.6717408*^9, 0}, {3.6723456*^9, 39},
      RoundingRadius->0], 
     RectangleBox[{3.6723456*^9, 0}, {3.6729504*^9, 252},
      RoundingRadius->0], RectangleBox[{3.6729504*^9, 0}, {3.6735552*^9, 90},
      RoundingRadius->0], RectangleBox[{3.6735552*^9, 0}, {3.67416*^9, 218},
      RoundingRadius->0], RectangleBox[{3.67416*^9, 0}, {3.6747648*^9, 115},
      RoundingRadius->0], 
     RectangleBox[{3.6747648*^9, 0}, {3.6753696*^9, 318},
      RoundingRadius->0], 
     RectangleBox[{3.6753696*^9, 0}, {3.6759744*^9, 312},
      RoundingRadius->0], RectangleBox[{3.6759744*^9, 0}, {3.6765792*^9, 96},
      RoundingRadius->0], RectangleBox[{3.6765792*^9, 0}, {3.677184*^9, 277},
      RoundingRadius->0], RectangleBox[{3.677184*^9, 0}, {3.6777888*^9, 143},
      RoundingRadius->0], RectangleBox[{3.6777888*^9, 0}, {3.6783936*^9, 63},
      RoundingRadius->0], RectangleBox[{3.6783936*^9, 0}, {3.6789984*^9, 41},
      RoundingRadius->0], RectangleBox[{3.6789984*^9, 0}, {3.6796032*^9, 79},
      RoundingRadius->0], RectangleBox[{3.6796032*^9, 0}, {3.680208*^9, 118},
      RoundingRadius->0], RectangleBox[{3.680208*^9, 0}, {3.6808128*^9, 100},
      RoundingRadius->0], 
     RectangleBox[{3.6814176*^9, 0}, {3.6820224*^9, 117},
      RoundingRadius->0], RectangleBox[{3.6820224*^9, 0}, {3.6826272*^9, 44},
      RoundingRadius->0], RectangleBox[{3.6826272*^9, 0}, {3.683232*^9, 21},
      RoundingRadius->0], 
     RectangleBox[{3.6838368*^9, 0}, {3.6844416*^9, 139},
      RoundingRadius->0], 
     RectangleBox[{3.6844416*^9, 0}, {3.6850464*^9, 129},
      RoundingRadius->0], 
     RectangleBox[{3.6850464*^9, 0}, {3.6856512*^9, 106},
      RoundingRadius->0], RectangleBox[{3.6856512*^9, 0}, {3.686256*^9, 185},
      RoundingRadius->0], RectangleBox[{3.686256*^9, 0}, {3.6868608*^9, 177},
      RoundingRadius->
       0]}, {}, {}}, {{}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, \
{}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, \
{}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, \
{}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, \
{}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{3.620236032*^9, 0},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {{{3.6215424*^9, 
       FormBox["\"10/6/14\"", TraditionalForm], {0, 0.01}}, {3.6324288*^9, 
       FormBox["\"2/9/15\"", TraditionalForm], {0, 0.01}}, {3.6433152*^9, 
       FormBox["\"6/15/15\"", TraditionalForm], {0, 0.01}}, {3.6542016*^9, 
       FormBox["\"10/19/15\"", TraditionalForm], {0, 0.01}}, {3.665088*^9, 
       FormBox["\"2/22/16\"", TraditionalForm], {0, 0.01}}, {3.6759744*^9, 
       FormBox["\"6/27/16\"", TraditionalForm], {0, 0.01}}, {3.6868608*^9, 
       FormBox["\"10/31/16\"", TraditionalForm], {0, 0.01}}}, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  PlotRange->{{3.6215424*^9, 3.6868608*^9}, {All, All}},
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.02], 
     Scaled[0.05]}},
  Ticks->{{{3.6215424*^9, 
      FormBox["\"10/6/14\"", TraditionalForm], {0, 0.01}}, {3.6324288*^9, 
      FormBox["\"2/9/15\"", TraditionalForm], {0, 0.01}}, {3.6433152*^9, 
      FormBox["\"6/15/15\"", TraditionalForm], {0, 0.01}}, {3.6542016*^9, 
      FormBox["\"10/19/15\"", TraditionalForm], {0, 0.01}}, {3.665088*^9, 
      FormBox["\"2/22/16\"", TraditionalForm], {0, 0.01}}, {3.6759744*^9, 
      FormBox["\"6/27/16\"", TraditionalForm], {0, 0.01}}, {3.6868608*^9, 
      FormBox["\"10/31/16\"", TraditionalForm], {0, 0.01}}}, 
    Automatic}]], "Output",
 CellChangeTimes->{3.695139205839775*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Export All Chat History as CSV", "Subsection",
 CellChangeTimes->{{3.695139217451602*^9, 3.695139225206373*^9}}],

Cell["\<\
The file will be placed in your working directory if not specified.
Each line of chat data is of form: date string, sender(0 is yourself, 1 is \
the other, automatic specify person in groups), contents.
Different people/groups are separated by a line of user identity, it is of \
form: internal ID, name, user ID(if available), nickname(if available), gender.
Please note that exporting can take minutes if the database is large. And \
opening the CSV file with a professional text editor is strongly recommended, \
it can crash some editors that can\[CloseCurlyQuote]t handle big files.\
\>", "Text",
 CellChangeTimes->{{3.695139293288022*^9, 3.695139594379627*^9}, 
   3.695139768322069*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"exportAllHistory", "[", "\"\<history.csv\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.69513924679941*^9, 3.6951392548560123`*^9}, 
   3.695139384252905*^9},
 CellLabel->"In[43]:=",ExpressionUUID->"6c210926-caf3-474f-baf4-5902e32843f1"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"131.887584`", ",", "\<\"history.csv\"\>"}], "}"}]], "Output",
 CellChangeTimes->{3.6951393637328987`*^9, 3.6951394912133293`*^9, 
  3.707190770854744*^9},
 CellLabel->"Out[43]=",
 CellID->1823041649,ExpressionUUID->"4375b1fc-9fd3-40c7-a529-ca3479b101e0"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1436, 855},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"11.1 for Mac OS X x86 (32-bit, 64-bit Kernel) (April 18, \
2017)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 160, 2, 96, "Section", "ExpressionUUID" -> \
"f648408f-d168-4965-bae5-b6cf7f29c102"],
Cell[743, 26, 479, 13, 224, "Text", "ExpressionUUID" -> \
"4e08a831-78c9-4605-86ee-ccc52aa0af0e"],
Cell[1225, 41, 265, 5, 47, "Text", "ExpressionUUID" -> \
"e9867846-da8d-4f5f-bb9e-2bf6a6ca8092"],
Cell[CellGroupData[{
Cell[1515, 50, 169, 3, 65, "Subsection", "ExpressionUUID" -> \
"621b03b7-8eff-418a-bf96-568020b65cd9"],
Cell[1687, 55, 17521, 485, 2122, "Input", "ExpressionUUID" -> \
"e3631668-d57d-4c2f-ab28-48ab1b883b58",
 InitializationCell->True],
Cell[19211, 542, 363, 6, 47, "Text", "ExpressionUUID" -> \
"c87a5c82-b1c0-461d-af71-4dbcf38a58a6"],
Cell[19577, 550, 213, 2, 47, "Text", "ExpressionUUID" -> \
"300e572b-20c1-4e4e-bc28-30cc0997b916",
 CellID->665306374],
Cell[19793, 554, 981, 21, 112, "Input", "ExpressionUUID" -> \
"d50c5fa1-8e61-4148-9975-06c30922aaeb"]
}, Open  ]],
Cell[CellGroupData[{
Cell[20811, 580, 105, 1, 65, "Subsection", "ExpressionUUID" -> \
"7ad6d2e5-a0e2-4c03-8dc6-16158f4959aa"],
Cell[CellGroupData[{
Cell[20941, 585, 1725, 37, 174, "Input", "ExpressionUUID" -> \
"bf0b41aa-e669-4f28-87c4-196388c9f984"],
Cell[22669, 624, 781, 15, 81, "Output", "ExpressionUUID" -> \
"4aa8d903-9347-417c-83be-f17fe3136ece",
 CellID->479160567]
}, Open  ]],
Cell[CellGroupData[{
Cell[23487, 644, 1709, 41, 205, "Input", "ExpressionUUID" -> \
"dcd6b3bb-4896-46f6-96af-5d12d44b9d70",
 CellID->1695817538],
Cell[25199, 687, 5048, 168, 236, "Output", "ExpressionUUID" -> \
"55aefe11-b8e6-4e56-8634-b0a8e93f9006",
 CellID->1922134355]
}, Open  ]],
Cell[CellGroupData[{
Cell[30284, 860, 1544, 34, 143, "Input", "ExpressionUUID" -> \
"87be7e43-ac51-4c45-b742-b91355f9a79e"],
Cell[31831, 896, 742, 13, 81, "Output", "ExpressionUUID" -> \
"60b1dbed-c2a7-4049-af5c-82aa64ae7dc1",
 CellID->1314082559]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[32622, 915, 127, 1, 65, "Subsection", "ExpressionUUID" -> \
"a6318045-778a-40e7-b007-2b26b2aeb964"],
Cell[32752, 918, 540, 15, 81, "Input", "ExpressionUUID" -> \
"c14db001-879e-457c-b5fb-dfeb5ae8f62f"],
Cell[CellGroupData[{
Cell[33317, 937, 1069, 26, 112, "Input", "ExpressionUUID" -> \
"d8f99686-e904-493e-9789-f84d79c9e255"],
Cell[34389, 965, 316, 8, 62, "Output", "ExpressionUUID" -> \
"432c1a54-f8e5-4c82-abe7-687157da45a0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[34742, 978, 2323, 55, 236, "Input", "ExpressionUUID" -> \
"1ad33aa7-9466-4fa0-828b-000763a47643"],
Cell[37068, 1035, 5000, 169, 205, "Output", "ExpressionUUID" -> \
"2e8544d1-1d38-4fc2-b3ee-b2c2e13a701d",
 CellID->1770324310]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[42117, 1210, 112, 1, 65, "Subsection", "ExpressionUUID" -> \
"d918fbdd-b958-42b4-9404-bf4707ba2491"],
Cell[42232, 1213, 729, 18, 112, "Input", "ExpressionUUID" -> \
"835ce086-2f7a-4e86-9e85-516dddd0b7de"],
Cell[CellGroupData[{
Cell[42986, 1235, 1762, 40, 174, "Input", "ExpressionUUID" -> \
"055a8502-dfd6-4f0f-94e1-89013b67378b"],
Cell[44751, 1277, 11690, 290, 365, "Output", "ExpressionUUID" -> \
"4bff8605-b2fa-4caa-83aa-f52b15e82a76"]
}, Open  ]],
Cell[CellGroupData[{
Cell[56478, 1572, 668, 18, 81, "Input", "ExpressionUUID" -> \
"d09a8efb-eb64-445f-af8c-b8d6606266b8"],
Cell[57149, 1592, 8816, 157, 350, "Output", "ExpressionUUID" -> \
"c60c9f33-be26-4aa4-af37-d10f7479b118"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[66014, 1755, 118, 1, 65, "Subsection", "ExpressionUUID" -> \
"e9f1df1e-c333-45d4-ad2a-08502e46db1c"],
Cell[66135, 1758, 703, 11, 195, "Text", "ExpressionUUID" -> \
"697d1954-c9e4-4a4a-a3dc-b1541a7f7c64"],
Cell[CellGroupData[{
Cell[66863, 1773, 259, 4, 49, "Input", "ExpressionUUID" -> \
"6c210926-caf3-474f-baf4-5902e32843f1"],
Cell[67125, 1779, 294, 6, 49, "Output", "ExpressionUUID" -> \
"4375b1fc-9fd3-40c7-a529-ca3479b101e0",
 CellID->1823041649]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

